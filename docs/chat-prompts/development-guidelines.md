# 開発ガイドライン

## 開発フロー

### 1. 新しい機能開発時

1. **issue 確認**: GitHub MCP で現在の issue 状況を確認
2. **ブランチ作成**: `feature/issue-{番号}-{タイトル}`形式でブランチを作成
3. **PRD 確認**: `docs/prd/requirements.md`を確認
4. **Figma 分析**: MCP を使用してデザイン詳細を取得
5. **実装**: セクションごとに段階的実装
6. **テスト**: Linter Errors の確認と修正
7. **コミット**: 日本語メッセージでコミット（`fixes #{issue番号}`を含める）
8. **push**: コミット完了後に push
9. **PR 作成**: 実装完了後に Pull Request を作成（GitHub Copilot をレビュー依頼者に設定）
10. **レビュー**: GitHub Copilot によるコードレビューを実施し、必要に応じて修正
11. **マージ**: レビュー完了後に main ブランチにマージ
12. **issue 更新**: 完了した issue をクローズ

### 2. コード品質管理

- **Linter Errors**: すべて修正してからコミット
- **コード可読性**: 適切なコメントと構造
- **JSDocs コメント**: 全ての関数・クラス・インターフェースに日本語の JSDocs コメントを記述
- **デザイン忠実性**: Figma デザインとの一致度確認
- **Tailwind CSS 優先**: style 属性は可能な限り使用せず、Tailwind CSS クラスでスタイリング

### 3. ファイル命名規則

- **HTML**: `index.html`, `section-name.html`
- **CSS**: `styles.css`, `section-name.css`
- **JavaScript**: `script.js`, `section-name.js`
- **画像**: `images/`ディレクトリに配置

### 4. ブランチ命名規則

- **機能開発**: `feature/issue-{番号}-{タイトル}`
  - 例: `feature/issue-15-mv-section-implementation`
- **バグ修正**: `fix/issue-{番号}-{タイトル}`
  - 例: `fix/issue-23-responsive-layout-bug`
- **ドキュメント**: `docs/issue-{番号}-{タイトル}`
  - 例: `docs/issue-8-readme-update`

### 5. コンポーネント設計規則

#### サーバーコンポーネント

- **page.tsx**: サーバーコンポーネントとして実装
- **layout.tsx**: サーバーコンポーネントとして実装
- **メタデータ**: SEO 対応のための metadata 設定
- **静的コンテンツ**: サーバーサイドでレンダリング可能なコンテンツ

#### クライアントコンポーネント

- **命名規則**: `{ComponentName}Client.tsx`
- **分離対象**: useState、useEffect、イベントハンドラーを含むコンポーネント
- **インポート**: サーバーコンポーネントから呼び出し

### 6. コミットメッセージ規則

- **形式**: `{タイプ}: {日本語での説明}`
- **タイプ**: feat, fix, docs, style, refactor, test, chore
- **issue 連携**: `fixes #{issue番号}`を含める
- **例**: `feat: MVセクションのレイアウト実装 fixes #15`

## 技術スタック

### フロントエンド

- **Next.js**: App Router、Server Components（最新版）
- **TypeScript**: 型安全性の確保
- **Tailwind CSS**: ユーティリティファースト CSS
  - **優先方針**: style 属性は可能な限り使用せず、Tailwind CSS クラスでスタイリング
  - **動的スタイル**: 必要最小限の場合のみ style 属性を使用
  - **レスポンシブ**: Tailwind のブレークポイントクラスを活用
  - **カスタムカラー**: プロジェクトで定義されたカスタムカラーを使用
- **Framer Motion**: アニメーションライブラリ
- **React Hook Form**: フォーム管理

### Next.js App Router コンポーネント設計

#### サーバーコンポーネントの使用方針

- **page.tsx**: サーバーコンポーネントとして実装
  - メタデータ（metadata）の設定
  - SEO 対応のための静的コンテンツ
  - クライアントコンポーネントの呼び出し
  - JSDocs コメントの追加

- **layout.tsx**: サーバーコンポーネントとして実装
  - フォント設定（next/font/google）
  - グローバルメタデータ
  - HTML 構造の定義
  - 共通レイアウト要素

#### クライアントコンポーネントの分離

- **インタラクティブな機能**: useState、useEffect、イベントハンドラーを含むコンポーネント
- **動的コンテンツ**: フォーム、モーダル、ナビゲーションなど
- **ファイル命名**: `{ComponentName}Client.tsx`形式で分離
- **インポート**: サーバーコンポーネントからクライアントコンポーネントを呼び出し

#### 実装例

```typescript
// page.tsx (サーバーコンポーネント)
import { Metadata } from "next";
import { HomeClient } from "./components/HomeClient";

export const metadata: Metadata = {
  title: "結婚式招待状",
  description: "美しい結婚式招待状のWebサイト",
};

export default function Home() {
  return (
    <main className="min-h-screen">
      <HomeClient />
    </main>
  );
}

// HomeClient.tsx (クライアントコンポーネント)
("use client");

import { useState } from "react";

export function HomeClient() {
  const [state, setState] = useState();
  // インタラクティブな機能を実装
}
```

### バックエンド

- **Next.js**: API Routes（最新版）
- **TypeScript**: 型安全性の確保
- **microCMS**: コンテンツ管理システム
- **Google Apps Script**: RSVP データ処理
- **Google Maps API**: 地図表示

### Figma 連携

- **MCP**: Figma-Context-MCP を使用
- **API**: Figma API でデザイン情報取得
- **デザインシステム**: Figma で定義された色・フォント・レイアウト

## レスポンシブ対応

### ブレークポイント

- **モバイル**: iPhone 13 mini（375px）
- **デスクトップ**: Desktop（1024px+）

### 実装方針

- **モバイルファースト**: モバイル優先で実装
- **プログレッシブエンハンスメント**: 基本機能から段階的拡張

## セクション実装順序

1. **MV (Main Visual)** - メインビジュアル
2. **Navigation** - ナビゲーション
3. **Countdown** - カウントダウン
4. **Host** - 新郎新婦紹介
5. **Message** - メッセージ
6. **Event** - イベント詳細
7. **Gallery** - 写真ギャラリー
8. **RSVP** - 出欠確認
9. **Footer** - フッター

## 品質チェックリスト

### コミット前確認

- [ ] Linter Errors が 0 件
- [ ] レスポンシブ対応確認
- [ ] Figma デザインとの一致度確認
- [ ] Tailwind CSS クラスを優先したスタイリング
- [ ] 日本語コミットメッセージ
- [ ] 適切なファイル構造
- [ ] issue 番号をコミットメッセージに含める
- [ ] JSDocs コメントが適切に記述されている

### push 前確認

- [ ] 実装が完了している
- [ ] コミットが完了している
- [ ] テストが通っている
- [ ] Linter Errors が 0 件

### PR 作成前確認

- [ ] 実装が完了している
- [ ] テストが通っている
- [ ] コミットメッセージが適切
- [ ] PR の説明に issue 番号を含める
- [ ] GitHub Copilot をレビュー依頼者に設定

### マージ前確認

- [ ] コードレビューが完了している
- [ ] 指摘事項が修正されている
- [ ] テストが通っている
- [ ] コンフリクトがない

### デプロイ前確認

- [ ] 全セクションの実装完了
- [ ] パフォーマンス最適化
- [ ] アクセシビリティ対応
- [ ] クロスブラウザテスト

## 進捗管理

### 1. GitHub MCP での issue 管理

#### issue の更新方法

- **進捗状況の更新**: issue の内容を直接編集して進捗を更新
- **ラベルの変更**: ステータスに応じてラベルを変更
  - `in-progress`: 進行中
  - `completed`: 完了
  - `blocked`: ブロック中
  - `review`: レビュー中
- **担当者の割り当て**: タスクの担当者を設定

#### コメントでの進捗報告

- **開始報告**: タスク開始時にコメントで報告
- **途中報告**: 実装中の進捗をコメントで更新
- **完了報告**: タスク完了時にコメントで報告
- **問題報告**: ブロック事項や問題をコメントで報告

#### 進捗報告のテンプレート

```
## 進捗状況
- [x] 完了したタスク
- [ ] 進行中のタスク
- [ ] 未着手のタスク

## 次のアクション
1. 次に実行するタスク
2. 必要な準備作業

## ブロック事項
なし（または問題の詳細）
```

### 2. 実装時の進捗管理

#### タスク開始時

1. issue にコメントで開始を報告
2. ラベルを `in-progress` に変更
3. 担当者を設定

#### 実装中

1. 定期的に進捗をコメントで更新
2. 問題が発生した場合は即座に報告
3. 必要に応じてラベルを `blocked` に変更

#### タスク完了時

1. 完了をコメントで報告
2. ラベルを `completed` に変更
3. issue をクローズ

### 3. ブロック事項の管理

#### 問題発生時

- issue にコメントで問題を詳細に報告
- ラベルを `blocked` に変更
- 解決策を issue に記載

## タスク完了フロー

### 1. 動作確認

#### 実装完了後の確認項目

- [ ] 実装した機能が正常に動作する
- [ ] Linter Errors が 0 件
- [ ] TypeScript エラーが 0 件
- [ ] レスポンシブ対応が正常
- [ ] Figma デザインとの一致度確認
- [ ] ブラウザでの表示確認（Chrome、Safari、Firefox）

#### 動作確認コマンド

```bash
# 開発サーバー起動
npm run dev

# Linter チェック
npm run lint

# TypeScript チェック
npx tsc --noEmit
```

### 2. コミット

#### コミット前確認

- [ ] 動作確認が完了している
- [ ] Linter Errors が 0 件
- [ ] 不要なファイルが含まれていない
- [ ] 適切なファイル構造になっている

#### コミット実行

```bash
# 変更をステージング
git add .

# 日本語コミットメッセージでコミット
git commit -m "feat: {実装内容の説明} fixes #{issue番号}"

# プッシュ
git push origin feature/issue-{番号}-{タイトル}
```

#### コミットメッセージ例

- `feat: プロジェクト構造の完成 fixes #20`
- `feat: MVセクションのレイアウト実装 fixes #24`
- `fix: レスポンシブ対応の修正 fixes #23`

### 3. Issue 完了

#### 完了報告

1. **issue の更新**: 完了したタスクにチェックマークを付ける
2. **完了報告の追加**: issue に完了報告セクションを追加
3. **ラベルの変更**: `completed` ラベルに変更
4. **issue のクローズ**: 完了後に issue をクローズ

#### 完了報告テンプレート

```
## 完了報告

### 実装内容
1. **実装した機能**
   - 具体的な実装内容
   - 使用した技術・ライブラリ

2. **作成したファイル**
   - 新規作成したファイル一覧
   - 修正したファイル一覧

3. **動作確認結果**
   - 確認した項目と結果
   - 問題があればその内容

### 次のステップ
- 次の issue 番号とタイトル
- 次に着手するタスク

### 技術的な詳細
- 使用した技術・ライブラリ
- 実装上の工夫点
- 今後の改善点
```

#### Issue 完了の手順

1. **動作確認完了**: すべての確認項目が完了
2. **コミット完了**: 適切なコミットメッセージでコミット
3. **issue 更新**: 完了報告を issue に追加
4. **ラベル変更**: `completed` ラベルに変更
5. **issue クローズ**: 完了後に issue をクローズ

#### 解決時

- 解決策をコメントで報告
- ラベルを `in-progress` に戻す
- 次のアクションを明確化

### 4. 品質管理との連携

#### レビュー前

- ラベルを `review` に変更
- レビュー依頼をコメントで報告

#### レビュー後

- 指摘事項を issue に記載
- 修正完了後にラベルを `completed` に変更

### 5. 進捗管理のベストプラクティス

- **定期的な更新**: 最低でも週 1 回は進捗を更新
- **詳細な報告**: 具体的な進捗状況を報告
- **問題の早期発見**: ブロック事項は即座に報告
- **完了条件の明確化**: いつ完了するかを明確に
- **次のアクション**: 常に次のステップを明確化
