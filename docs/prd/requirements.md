# 結婚式 Web 招待状 要件定義書

## 1. プロジェクト概要

### 1.1 プロジェクト名

結婚式 Web 招待状

### 1.2 目的

Figma で作成されたデザインを基に、結婚式の Web 招待状を実装する

### 1.3 デザインテーマ

- **ディズニーテーマ**: 特にラプンツェルをモチーフとしたデザイン
- **アニメーション重視**: 動きのあるサイトとして実装
- **Figma MCP 活用**: 常に最新のデザインデータを参照

### 1.4 対象ユーザー

- 結婚式招待客
- 二次会招待客
- 主にスマートフォンでの閲覧を想定（PC での閲覧も動作保証）

## 2. 機能要件

### 2.1 ページ構成（Figma デザインから読み取り）

#### 2.1.1 レスポンシブ対応

- **iPhone 13 mini**: モバイル版デザイン
- **Desktop**: デスクトップ版デザイン

#### 2.1.2 セクション構成

1. **MV (Main Visual)**

   - メインビジュアルセクション
   - 結婚式の印象的な画像やアニメーション

2. **Countdown**

   - 結婚式までのカウントダウン機能
   - 日時表示

3. **Navigation**

   - ナビゲーションメニュー
   - 各セクションへのスムーズな移動

4. **Host**

   - 新郎新婦の紹介セクション
   - プロフィール情報

5. **Message**

   - 新郎新婦からのメッセージ
   - 招待状の本文
   - **招待者別コンテンツ**: 招待者ごとにカスタマイズされたメッセージ

6. **Gallery**

   - 写真ギャラリー
   - 新郎新婦の思い出写真

7. **Event**

   - 結婚式の詳細情報
   - 日時、会場、アクセス情報
   - **Google Maps 連携**: 会場の地図表示とルート案内

8. **RSVP**

   - 出欠確認フォーム
   - 参加者情報の入力
   - **招待者別フォーム**: 招待者ごとにカスタマイズされたフォーム
   - **お連れ様フォーム**: お連れ様が設定されている場合の自動表示
   - **参加者管理**: 招待者 + お連れ様の参加者リスト管理
   - **データ保存**: Google スプレッドシートへの自動保存

9. **Footer**
   - フッター情報
   - 連絡先、その他の情報

### 2.2 技術要件

#### 2.2.1 フロントエンド技術スタック

- **フレームワーク**: Next.js 14 (App Router)
- **言語**: TypeScript
- **スタイリング**: Tailwind CSS + CSS Modules
- **アニメーション**: Framer Motion
- **状態管理**: React Context API
- **フォーム**: React Hook Form + Zod
- **画像最適化**: Next.js Image Component
- **地図**: Google Maps JavaScript API
- **データ保存**: Google Sheets API

#### 2.2.2 レスポンシブ対応

- **ブレークポイント** (Tailwind CSS デフォルト):
  - `sm`: 640px 以上
  - `md`: 768px 以上
  - `lg`: 1024px 以上
  - `xl`: 1280px 以上
  - `2xl`: 1536px 以上
- **デバイス対応**: iPhone 13 mini, iPad, Desktop
- **タッチ操作**: スワイプ、タップ対応

#### 2.2.3 デザインシステム

- **カラーパレット**: Figma で定義された色を使用（Tailwind 設定）
- **タイポグラフィ**: Google Fonts (ラプンツェルテーマに適したフォント)
- **アイコン**: Lucide React / Heroicons
- **レイアウト**: CSS Grid + Flexbox
- **Figma MCP 連携**: デザイントークンの自動同期

#### 2.2.4 アニメーション要件

- **ライブラリ**: Framer Motion
- **スクロールアニメーション**: Intersection Observer API
- **ホバーエフェクト**: CSS Transitions + Framer Motion
- **ローディングアニメーション**: Skeleton Loading
- **パララックス効果**: CSS Transform + Scroll Events
- **パフォーマンス**: GPU アクセラレーション活用

#### 2.2.5 開発環境

- **パッケージマネージャー**: npm
- **リンター**: ESLint + Prettier
- **型チェック**: TypeScript
- **開発サーバー**: Next.js Dev Server
- **ビルドツール**: Next.js Build System

#### 2.2.6 招待者管理システム

- **CMS**: microCMS
- **招待者識別**: URL パラメータ `https://ドメイン/[id]`
- **データ構造**:
  - **ID**: microCMS でデフォルトで振られるユニークな ID
  - **名前**: 招待者の名前
  - **招待種別**: 挙式/披露宴/二次会（チェックボックスで複数選択可能）
  - **メッセージ**: Message セクションで表示されるカスタムメッセージ
  - **お連れ様**: 他のユーザー ID を配列で参照
    - お連れ様が設定されている場合、デフォルトでお連れ様のフォームを表示
- **API 設計**:
  - microCMS API を使用した招待者データ取得
  - 招待者 ID による個別データ取得
  - お連れ様データの関連取得
- **セキュリティ**: 招待者 ID の推測困難化
- **エラーハンドリング**: 無効な ID アクセス時の適切な処理

#### 2.2.7 RSVP データ管理システム

- **データ保存先**: Google スプレッドシート
- **API 連携**: Google Apps Script + Google Sheets API
- **データ構造**:
  - 招待者 ID
  - 招待者名
  - 参加予定イベント（挙式/披露宴/二次会）
  - 参加人数
  - お連れ様情報
  - メッセージ
  - 送信日時
- **セキュリティ**: Google Apps Script での認証
- **エラーハンドリング**: 送信失敗時の適切な処理

#### 2.2.8 招待者データ型定義

```typescript
interface Guest {
  id: string; // microCMSのデフォルトID
  name: string; // 招待者名
  invitationType: ("ceremony" | "reception" | "afterparty")[]; // 招待種別（複数選択可能）
  message?: string; // カスタムメッセージ
  companions?: string[]; // お連れ様のID配列
}

interface Companion {
  id: string; // お連れ様のID
  name: string; // お連れ様名
  relationship?: string; // 関係性
}
```

### 2.3 非機能要件

#### 2.3.1 パフォーマンス要件

- **Core Web Vitals**:
  - LCP (Largest Contentful Paint): 2.5 秒以内
  - FID (First Input Delay): 100ms 以内
  - CLS (Cumulative Layout Shift): 0.1 以下
- **画像最適化**: WebP 形式、適切なサイズ設定
- **バンドルサイズ**: 初期ロード 200KB 以下
- **キャッシュ戦略**: 静的アセットの長期キャッシュ

#### 2.3.2 ユーザビリティ要件

- **ナビゲーション**: スムーズスクロール、アンカーリンク
- **タッチ操作**: 44px 以上のタッチターゲット
- **読み込み状態**: スケルトンローディング表示
- **エラーハンドリング**: 適切なエラーメッセージ表示

#### 2.3.3 アクセシビリティ要件

- **WCAG 2.1 AA 準拠**:
  - コントラスト比 4.5:1 以上
  - キーボードナビゲーション対応
- スクリーンリーダー対応
- **セマンティック HTML**: 適切な HTML 構造
- **ARIA 属性**: 必要な箇所に ARIA 属性追加

#### 2.3.4 ブラウザ対応

- **モダンブラウザ**: Chrome 90+, Firefox 88+, Safari 14+
- **モバイルブラウザ**: iOS Safari 14+, Android Chrome 90+
- **プログレッシブエンハンスメント**: 基本機能は古いブラウザでも動作

#### 2.3.5 招待者管理セキュリティ

- **URL セキュリティ**: 招待者 ID の推測困難化（長いランダム文字列）
- **アクセス制御**: 招待者ごとの適切なコンテンツ表示
- **データ保護**: 他の招待者の情報が表示されないよう制御
- **エラー処理**: 無効な ID アクセス時の適切なエラーページ表示
- **ログ管理**: アクセスログの記録（プライバシー配慮）

## 3. 実装方針

### 3.1 開発アプローチ

1. **Figma デザインの解析**: MCP を使用してデザイン情報を取得
2. **Figma MCP 活用**: 常に最新のデザインデータを参照
3. **招待者管理システム**: microCMS 連携と URL ベース識別
4. **コンポーネント設計**: 再利用可能なコンポーネントの作成
5. **レスポンシブ実装**: モバイルファーストアプローチ
6. **アニメーション実装**: ディズニーテーマに合わせた動きの演出
7. **段階的実装**: セクションごとの実装とテスト

### 3.2 品質管理

- **Linter Errors**: すべての linting エラーを修正
- **コード品質**: 可読性と保守性を重視
- **デザイン忠実性**: Figma デザインとの一致度を確認

## 4. 成果物

### 4.1 デリバラブル

- 結婚式 Web 招待状の HTML/CSS/JavaScript ファイル
- レスポンシブ対応の Web サイト
- 出欠確認フォーム機能

### 4.2 ドキュメント

- 要件定義書（本ドキュメント）
- 実装ガイド
- デプロイ手順書

## 5. 制約事項

### 5.1 技術制約

- **Figma-Context-MCP の利用**: デザイン情報の取得と同期
- **静的サイト生成**: Next.js Static Export
- **CDN 配信**: Vercel/Netlify 等での配信
- **モダンブラウザ対応**: ES2017+対応

### 5.2 セキュリティ要件

- **Figma API キー**: 環境変数での安全な管理
- **Google Maps API キー**: 環境変数での安全な管理
- **Google Apps Script 認証**: Google サービスアカウントでの認証
- **個人情報保護**: RSVP フォームの適切な処理
- **HTTPS 必須**: 全通信の暗号化
- **CSP 設定**: Content Security Policy の実装

### 5.3 運用制約

- **ホスティング**: Vercel
- **デプロイ**: GitHub Actions + Vercel
- **ドメイン**: カスタムドメイン使用
- **監視**: Google Analytics 4
- **バックアップ**: コードとアセットの定期バックアップ

## 6. 今後の展開

### 6.1 追加機能の検討

- アニメーション効果
- Google Maps 連携機能

### 6.2 運用・保守

- 定期的なコンテンツ更新
- パフォーマンス監視
- セキュリティアップデート
